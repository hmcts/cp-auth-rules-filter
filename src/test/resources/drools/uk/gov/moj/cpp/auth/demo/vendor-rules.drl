package uk.gov.moj.cpp.authz.demo;

import uk.gov.moj.cpp.authz.drools.Outcome;
import uk.gov.moj.cpp.authz.drools.AuthAction;

global uk.gov.moj.cpp.authz.http.providers.UserAndGroupProvider userAndGroupProvider;

// --- Vendor-style actions resolved from Content-Type / Accept ---

rule "Allow sjp.delete-financial-means for LA"
when
  $o: Outcome()
  $a: AuthAction(name == "sjp.delete-financial-means")
  eval(userAndGroupProvider.isMemberOfAnyOfTheSuppliedGroups($a, "Legal Advisers"))
then
  $o.setSuccess(true);
end

rule "Allow hearing.get-draft-result for LA"
when
  $o: Outcome()
  $a: AuthAction(name == "hearing.get-draft-result")
  eval(userAndGroupProvider.isMemberOfAnyOfTheSuppliedGroups($a, "Legal Advisers"))
then
  $o.setSuccess(true);
end
